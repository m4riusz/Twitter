<template>
    <require from="../../../templates/user/user-template.html"></require>
    <require from="../../../templates/tag/tag-template.html"></require>

    <user-template user.bind="currentLoggedUser" date.bind = "true"></user-template>

    <div if.bind="currentLoggedUser.favouriteTags.length > 0">
        <h4>My favourite tags:</h4>
        <tag-template repeat.for="tag of currentLoggedUser.favouriteTags" tag.bind="tag"></tag-template>
    </div>
    <hr/>
    <div class="panel-group">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <strong>Change avatar</strong>
                </h4>
            </div>

            <div class="panel-body">
                <div if.bind = "avatarMessage.text != '' && avatarMessage.type == 'SUCCESS'" class="alert alert-success">${avatarMessage.text}</div>
                <div if.bind = "avatarMessage.text != '' && avatarMessage.type == 'PROGRESS'" class="alert alert-warning">${avatarMessage.text}</div>
                <div if.bind = "avatarMessage.text != '' && avatarMessage.type == 'FAIL'" class="alert alert-danger">${avatarMessage.text}</div>
                <input type="file" id="fileInput" class="file" files.bind="selectedFiles"
                       accept="image/png, image/jpeg, image/jpg"
                       style="visibility: hidden; position: absolute;">

                <div class="form-inline">
                    <label for="file">File:</label>
                    <input type="email" class="form-control" id="file" disabled value.bind="selectedFiles[0].name">
                    <a class="btn btn-default" click.delegate="openFile()">Browse</a>
                    <a if.bind="selectedFiles.length == 1" class="btn btn-default" click.delegate="changeAvatar()">Change
                        avatar</a>
                </div>

            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <strong>Change password</strong>
                </h4>
            </div>
            <div class="panel-body">
                <div if.bind = "passwordMessage.text != '' && passwordMessage.type == 'SUCCESS'" class="alert alert-success">${passwordMessage.text}</div>
                <div if.bind = "passwordMessage.text != '' && passwordMessage.type == 'PROGRESS'" class="alert alert-warning">${passwordMessage.text}</div>
                <div if.bind = "passwordMessage.text != '' && passwordMessage.type == 'FAIL'" class="alert alert-danger">${passwordMessage.text}</div>

                <form class="form-horizontal">
                    <div class="form-group">
                        <label for="newPassword" class="col-sm-2 control-label">New password</label>
                        <div class="col-sm-10">
                            <input type="password" class="form-control" id="newPassword" ref="newPassword"
                                   placeholder="New password">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="reNewPassword" class="col-sm-2 control-label">Repeat new password</label>
                        <div class="col-sm-10">
                            <input type="password" class="form-control" id="reNewPassword" ref="reNewPassword"
                                   placeholder="Repeat new password">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <a class="btn btn-default"
                               click.delegate="changePassword(newPassword.value,reNewPassword.value)">Change
                                password</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <strong>Change email</strong>
                </h4>
            </div>
            <div class="panel-body">
                <div if.bind = "emailMessage.text != '' && emailMessage.type == 'SUCCESS'" class="alert alert-success">${emailMessage.text}</div>
                <div if.bind = "emailMessage.text != '' && emailMessage.type == 'PROGRESS'" class="alert alert-warning">${emailMessage.text}</div>
                <div if.bind = "emailMessage.text != '' && emailMessage.type == 'FAIL'" class="alert alert-danger">${emailMessage.text}</div>

                <form class="form-horizontal">
                    <div class="form-group">
                        <label for="newEmail" class="col-sm-2 control-label">New email</label>
                        <div class="col-sm-10">
                            <input type="email" class="form-control" id="newEmail" ref="newEmail"
                                   placeholder="New email">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="reNewEmail" class="col-sm-2 control-label">Repeat new email</label>
                        <div class="col-sm-10">
                            <input type="email" class="form-control" id="reNewEmail" ref="reNewEmail"
                                   placeholder="Repeat new email">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <a class="btn btn-default"
                               click.delegate="changeEmail(newEmail.value,reNewEmail.value)">Change email</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</template>